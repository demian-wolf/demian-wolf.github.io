{% extends 'base.html' %}

{% macro unpack_text(paragraphs, safe=True) -%}
    {% for paragraph in paragraphs %}
        <p>{{ paragraph|safe if safe else paragraph }}</p>
    {% endfor %}
{%- endmacro %}

{% macro unpack_image(id, alt, attrs) -%}
    {% set src = attrs.pop('src') %}
    <img id="{{ id }}"
         src="{{ src if src.startswith('http') else url_for('static', filename=src) }}"
         alt="{{ alt }}"
    {% for attr in attrs %}
        {{ attr }}="{{ attrs[attr] }}"
    {% endfor %}
/>
{%- endmacro %}

{% block title %}Home{% endblock %}

{% block head %}
    {% for stylesheet in ["index", "portfolio", "collapsible", "liteyt"] %}
        <link rel="stylesheet" href="{{ url_for('static', filename='stylesheet/' ~ stylesheet ~ '.css') }}">
    {% endfor %}
    {% for script in ["portfolio", "collapsible", "liteyt"] %}
        <script src="{{ url_for('static', filename='scripts/' ~ script ~ '.js') }}"></script>
    {% endfor %}
{% endblock %}

{% block content %}
    <div id="about-me" class="section">
        {% set about_me = index['about-me'] %}
        {{ unpack_image('about-me__photo', 'My Photo', about_me['photo']) }}
        <div id="about-me__text">
            {{ unpack_text(about_me['text']) }}
        </div>
    </div>

    <div id="sm-buttons" class="section">
        {% set social_media = index['social_media'] %}
        {% for sm in social_media %}
            <a class="button" href="{{ sm['href'] }}" target="_blank" title="{{ sm['name'] }}">
                <img src="{{ url_for('static', filename='images/social-media/' ~ sm['name'] ~ '.png') }}"
                     alt="{{ sm['name'] }}">
            </a>
        {% endfor %}
    </div>

    <div id="portfolio" class="section">
        <h2 class="section__name">Portfolio</h2>

        <div id="portfolio__tabs_buttons"></div>
        <div id="portfolio__tabs">
            <div class="portfolio__tab">
                <h3 class="portfolio__tab_caption">Academics & Athletics</h3>
                <h3>Achievements</h3>
                {% set academics_and_athletics = portfolio['academics-and-athletics'] %}
                <table>
                    <thead>
                    <tr>
                        <th>Achievement</th>
                        <th>Years &amp; Level</th>
                        <th>Additional Information</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for achievement in academics_and_athletics['achievements'] %}
                        <tr>
                            {% for key in achievement %}
                                <td>
                                    {{ achievement[key] if key == 'title' else unpack_text(achievement[key]) }}
                                </td>
                            {% endfor %}
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>

            <div class="portfolio__tab">
                <h3 class="portfolio__tab_caption">Software Development</h3>
                {% set software_development = portfolio['software-development'] %}
                <div>
                    <div>
                        <p>
                            I am a passionate software developer with
                            {{ software_development['years'] }}
                            years of experience with:
                        </p>
                        <ul>
                            {% for experience_li in software_development['experience'] %}
                                <li>{{ experience_li|safe }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="collapsible">
                        <p class="collapsible__title">
                            My Tech Stack (Programming Languages and Frameworks I work with)
                        </p>
                        <div class="collapsible__content">
                            <ul>
                                {% set tech_stack = software_development['tech-stack'] %}
                                {% for ts in tech_stack %}
                                    <li>
                                        <strong>{{ ts }}</strong>{% if tech_stack[ts] is not none %}:
                                        {{ tech_stack[ts]|join(', ') }}{% endif %}
                                    </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                    <div class="collapsible">
                        <p class="collapsible__title">
                            My Projects
                        </p>
                        <div class="collapsible__content">
                            {% set projects = software_development['projects'] %}
                            {% for project in projects %}
                                <p>
                                    <a href="{{ project['href'] }}">
                                        <strong>{{ project['name'] }}</strong>
                                    </a>
                                    {{ project['description'] }}
                                </p>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>

            <div class="portfolio__tab">
                <h3 class="portfolio__tab_caption">Community Service</h3>
                {% set community_service = portfolio['community-service'] %}

                <div>{{ unpack_text(description) }}</div>

                <div>
                    <h4>CodeClub</h4>
                    <div>
                        {{ unpack_image('codeclub-logo', 'The CodeClub logo', community_service['codeclub']['logo']) }}
                        {{ unpack_text(community_service['codeclub']['text']) }}
                    </div>
                </div>

                <div class="collapsible">
                    <p class="collapsible__title">
                        Video Gallery
                    </p>
                    <div class="collapsible__content">
                        <div class="portfolio__gallery">
                            {% for video in community_service['gallery'] %}
                                <div class="portfolio__gallery_item">
                                    <p>{{ video.title }}:</p>
                                    <div class="video">
                                        <a class="video__link" href="{{ 'https://youtu.be/' ~ video['id'] }}">
                                            <picture>
                                                <source srcset="{{ 'https://i.ytimg.com/vi_webp/' ~ video['id'] ~ '/maxresdefault.webp' }}"
                                                        type="image/webp">
                                                <img class="video__media"
                                                     src="{{ 'https://i.ytimg.com/vi/' ~ video['id'] ~ '/maxresdefault.jpg' }}"
                                                     alt="{{ video['title'] }}">
                                            </picture>
                                        </a>
                                        <button class="video__button" aria-label="Start Video Playback">
                                            <svg width="68" height="48" viewBox="0 0 68 48">
                                                <path class="video__button-shape"
                                                      d="M66.52,7.74c-0.78-2.93-2.49-5.41-5.42-6.19C55.79,.13,34,0,34,0S12.21,.13,6.9,1.55 C3.97,2.33,2.27,4.81,1.48,7.74C0.06,13.05,0,24,0,24s0.06,10.95,1.48,16.26c0.78,2.93,2.49,5.41,5.42,6.19 C12.21,47.87,34,48,34,48s21.79-0.13,27.1-1.55c2.93-0.78,4.64-3.26,5.42-6.19C67.94,34.95,68,24,68,24S67.94,13.05,66.52,7.74z"></path>
                                                <path class="video__button-icon" d="M 45,24 27,14 27,34"></path>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                <div>
                    <h4>Social Media</h4>
                    {{ unpack_text(community_service['social-media']['text']) }}
                </div>
            </div>

        </div>
    </div>
{% endblock %}
